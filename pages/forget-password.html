<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../lib/bootstrap-5.3.3-dist/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/icons/bootstrap-icons-1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../css/main.css">
    <title>DCD | ភ្លេចពាក្យសម្ងាត់</title>
    <style>
        body {
            overflow: hidden;

            header {
                position: fixed !important;
                width: 100% !important;

                #register-login {
                    display: flex !important;
                }

                #profile-avartar {
                    display: none !important;
                }
            }

            .forget-password-back {
                padding-inline: .5rem !important;

                &,
                &::before {
                    background: transparent !important;
                    background-color: transparent !important;
                    color: hsl(from var(--tc-tertiary) h s l) !important;
                }

            }

            label.tf-input-primary {
                background-color: hsl(from var(--tc-bg) h s l);
                &.valid {
                    border-color: hsl(from var(--tc-bg) h s l);

                    &:has(input:not(:focus)) {
                        background-color: hsl(from var(--tc-bg) h s l);

                        i {
                            color: hsl(from var(--tc-primary) h s l);
                        }

                        .form-floating {
                            label {
                                color: hsl(from var(--tc-primary) h s l);
                            }

                            input {
                                color: hsl(from var(--tc-text) h s l);
                            }
                        }
                    }
                }
            }
        }
    </style>
</head>

<body>
    <header></header>
    <main>
        <section class="forget-password">
            <div class="container">
                <div class="row g-0 justify-content-center">
                    <div class="col-7">
                        <div id="form-wrapper" class="email">
                            <form class="email">
                                <div class="row g-4 w-100">
                                    <div class="col-12">
                                        <div class="form-step">
                                            <span>១</span>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <span class="short-description">
                                            សូមបញ្ចូលអាសយដ្ឋានអ៊ីមែលដើម្បីទទួលលេខកូដសម្ងាត់ 4 ខ្ទង់
                                        </span>
                                    </div>
                                    <div class="col-12">
                                        <label for="primary-input" class="tf-input-primary">
                                            <i class="bi bi-envelope-at-fill"></i>
                                            <div class="form-floating">
                                                <input type="email" class="form-control" id="primary-input"
                                                    placeholder="អ៊ីម៉ែល"
                                                    oninput="inputRealTimeValidation(this, /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)">
                                                <label for="floatingInput">អ៊ីម៉ែល</label>
                                            </div>
                                            <i class="bi bi-exclamation-octagon-fill error-indicator"></i>
                                        </label>
                                        <span class="error-text">សូមបញ្ខូលតាមតម្រងអោយបានត្រឹមត្រូវ
                                            email@gmail.com</span>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn tb-primary"
                                            onclick="forgetPasswordNext()">ជំហ៊ានបន្ទាប់ <i
                                                class="bi bi-arrow-right"></i></button>
                                    </div>
                                </div>
                            </form>
                            <form class="otp">
                                <div class="row g-4 w-100">
                                    <div class="col-12">
                                        <div class="form-step">
                                            <span>២</span>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <span class="short-description">
                                            សូមបញ្ចូលលេខកូដសម្ងាត់ 4 ខ្ទង់
                                        </span>
                                    </div>
                                    <div class="col-12">
                                        <div class="input-otp-wrapper">
                                            <input type="text" maxlength="1" class="otp-input" />
                                            <input type="text" maxlength="1" class="otp-input" />
                                            <input type="text" maxlength="1" class="otp-input" />
                                            <input type="text" maxlength="1" class="otp-input" />
                                        </div>
                                    </div>
                                    <div class="col-12 text-end">
                                        <div class="d-flex justify-content-between">
                                            <button type="button" class="btn tb-secondary forget-password-back"
                                                onclick="forgetPasswordBack()"><i class="bi bi-arrow-left"></i>
                                                ត្រឡប់ក្រោយ</button>
                                            <button type="button" class="btn tb-primary"
                                                onclick="forgetPasswordNext()">ជំហ៊ានបន្ទាប់ <i
                                                    class="bi bi-arrow-right"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <form class="password" onsubmit="requestResetPassword()">
                                <div class="row g-4 w-100">
                                    <div class="col-12">
                                        <div class="form-step">
                                            <span>៣</span>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <span class="short-description">
                                            <i class="bi bi-info-circle" style="color: var(--tc-accent) ;"></i>
                                            សូមបញ្ចូលពាក្យសម្ងាត់ថ្មី និងផ្ទៀងផ្ទាត់ពាក្យសម្ងាត់អោយបានត្រឹមត្រូវ
                                        </span>
                                    </div>
                                    <div class="col-12">
                                        <label for="password" class="tf-input-primary">
                                            <i class="bi bi-lock-fill"></i>
                                            <div class="form-floating">
                                                <input type="password" class="form-control" id="password"
                                                    placeholder="ពាក្យសម្ងាត់"
                                                    oninput="inputRealTimeValidation(this, /^[a-zA-Z0-9]{8,}$/)">
                                                <label for="floatingInput">ពាក្យសម្ងាត់ថ្មី</label>
                                            </div>
                                            <i class="bi bi-exclamation-octagon-fill error-indicator"></i>
                                        </label>
                                        <span class="error-text">ពាក្យសម្ងាត់មិនតិចជាង 8 ខ្ទង់</span>
                                    </div>
                                    <div class="col-12">
                                        <label for="confirm-password" class="tf-input-primary">
                                            <i class="bi bi-key-fill"></i>
                                            <div class="form-floating">
                                                <input type="password" class="form-control" id="confirm-password"
                                                    placeholder="ផ្ទៀងផ្ទាត់ពាក្យសម្ងាត់"
                                                    oninput="inputRealTimeValidation(this, new RegExp('^' + document.getElementById('password').value.replace(/[-\\/\\^$*+?.()|[\\]{}]/g, '\\\\$&') + '$'))">
                                                <label for="floatingInput">ផ្ទៀងផ្ទាត់ពាក្យសម្ងាត់</label>
                                            </div>
                                            <i class="bi bi-exclamation-octagon-fill error-indicator"></i>
                                        </label>
                                        <span class="error-text">ពាក្យសម្ងាត់មិនផ្ទៀងផ្ទាត់</span>
                                    </div>
                                    <div class="col-12 text-end">
                                        <div class="d-flex justify-content-between">
                                            <button type="button" class="btn tb-secondary forget-password-back"
                                                onclick="forgetPasswordBack()"><i class="bi bi-arrow-left"></i>
                                                ត្រឡប់ក្រោយ</button>
                                            <button type="submit" class="btn tb-primary"
                                                onclick="forgetPasswordNext()">ស្នើពាក្យសម្ងាត់ថ្មី</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script src="../js/main.js"></script>
    <script src="../js/header.js"></script>
    <script src="../js/pre-loader.js"></script>
    <script src="../js/popup.js"></script>


    <script>
        function forgetPasswordNext() {
            var form_wrapper = document.getElementById("form-wrapper");
            if (form_wrapper.classList.contains('email')) {
                form_wrapper.classList.remove('email');
                form_wrapper.classList.add('otp');
            }
            else if (form_wrapper.classList.contains('otp')) {
                form_wrapper.classList.remove('otp');
                form_wrapper.classList.add('password');
            }
        }

        function forgetPasswordBack() {
            var form_wrapper = document.getElementById("form-wrapper");
            if (form_wrapper.classList.contains('password')) {
                form_wrapper.classList.remove('password');
                form_wrapper.classList.add('otp');
            }
            else if (form_wrapper.classList.contains('otp')) {
                form_wrapper.classList.remove('otp');
                form_wrapper.classList.add('email');
            }
        }

        const inputs = document.querySelectorAll('.otp-input');
        inputs.forEach((input, index) => {
            input.addEventListener('input', () => {
                if (input.value.length === 1 && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
            });
        });

        function requestResetPassword() {
            event.preventDefault();
            (async () => {
                const isLoaded = await preLoader(3000);
                if (isLoaded) {
                    const isClick = await PopUpOption('ការប្តូពាក្យស្ងាត់បានជោគជ័យ', 'សូមត្រឡប់ទៅទំព័រចូលគណនីដើម្បីចូលប្រើប្រាស់', status = true, multiOption = false);
                    if (isClick) {
                        window.location.href = "login.html";
                    }
                }
            })();
        }
    </script>

</body>

</html>